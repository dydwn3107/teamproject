<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout}">

<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>

<link rel="stylesheet"
	href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
<link rel="stylesheet"
	href="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.css" />

<script
	src="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.js"></script>
<script src="https://uicdn.toast.com/tui-grid/latest/tui-grid.js"></script>

<!-- modal -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
	crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
	crossorigin="anonymous">
    </script>
</head>


<body>


	<div layout:fragment="content">
		<button type="button" onclick="selData();" class="btn btn-dark btn-sm"
			data-bs-toggle="modal" data-bs-target="#requestModal">생산계획
			작성</button>

		<script>
			function selData() {
				var datas = grid.getCheckedRows();
				var test = JSON.stringify(datas);
				alert(test);
			}
		</script>
		<div id="grid"></div>

		<!-- 생산요청서 모달 -->
		<div class="modal fade" id="requestModal" tabindex="-1"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-xl">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">생산요청서 목록</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<div>
							<div id="requestModalGrid" style="width: 100%;"></div>
						</div>
					</div>

				</div>
			</div>
		</div>

		<script>
   	
		
		
		// 생산요청서 모달
   $(document).on('shown.bs.modal','.modal', function () {
	   
      var requestModalGrid = new tui.Grid({
         el : document.getElementById('requestModalGrid'),
        
         scrollX : false,
         scrollY : false,
         rowHeaders : [ 'checkbox' ],
         columnOptions : {
            minWidth : 100
         },
         columns : [ 

				{
					header: '생산계획번호',
					name: 'planNo',
				},
				{
					header: '생산량',
					name: 'planQuantity',
				},
				{
					header: '시작일자(desc)',
					name: 'planStart',
					sortingType: 'desc',
					sortable: true
				},
				{
					header: '종료일자(desc)',
					name: 'planEnd',
					sortingType: 'desc',
					sortable: true
				},
				{
					header: '기타사항',
					name: 'planEx',
				},
				 ]
      });
   });
   </script>


		<script>
			window.onload = function () {

				$.ajax({
					url: "/plan",
					method: "GET",
					dataType: "JSON",
					success: function (result) {

						console.log(result);
						for (let plan of result) {
							plan.planStart = plan.planStart.substr(0, 10);
							plan.planEnd = plan.planEnd.substr(0, 10);
						}
						grid.resetData(result);
					},
					error: function (reject) {
						console.log(reject);
					}
				});
			};
			var grid = new tui.Grid({
				el: document.getElementById('grid'),
				rowHeaders: ['checkbox'],
				minBodyHeight: 30,
				pageOptions: {
					useClient: true, // front에서만 페이징 하는 속성
					perPage: 5
				},

				scrollX: false,
				scrollY: false,
				columns: [

					{
						header: '생산계획번호',
						name: 'planNo',
					},
					{
						header: '생산량',
						name: 'planQuantity',
					},
					{
						header: '시작일자(desc)',
						name: 'planStart',
						sortingType: 'desc',
						sortable: true
					},
					{
						header: '종료일자(desc)',
						name: 'planEnd',
						sortingType: 'desc',
						sortable: true
					},
					{
						header: '기타사항',
						name: 'planEx',
					},
					
				],
			});
		</script>

	</div>
</body>


</html>